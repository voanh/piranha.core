@model Piranha.Extend.Blocks.ImageBlock
@{
    var prefix = Html.ViewData.TemplateInfo.HtmlFieldPrefix
        .Replace("[", "_").Replace("]", "_").Replace(".", "_");
    var unique = "Image_" + Guid.NewGuid().ToString();
}

<div class="block-image">
    <img id="@(unique)_Preview" src="@(Model.Body.Media != null ? Url.Content(Model.Body.Media.PublicUrl) : "/assets/img/empty-image.png")">
    <div class="block-image-picker">
        @Html.HiddenFor(m => m.Body.Id)
        <div class="btn-group float-right" role="group">
            <div class="btn-group" role="group">
                <button class="btn btn-primary text-center" type="button" data-toggle="modal" data-target="#modalMedia" data-filter="image" data-mediaid="@(prefix)_Body_Id" data-medianame="@(unique)_Filename" data-mediaurlid="@(unique)_Preview">
                    <span class="fas fa-plus"></span>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-danger text-center btn-media-clear" type="button" data-mediaid="@(prefix)_Body_Id" data-medianame="@(unique)_Filename" data-mediaurlid="@(unique)_Preview">
                    <span class="fas fa-times"></span>
                </button>
            </div>
        </div>
        <div class="card text-left image-field">
            <div class="card-body">
                <a id="@(unique)_Filename" href="#" data-toggle="modal">
                    @if (Model.Body.Media != null) 
                    {
                        @Model.Body.Media.Filename
                    } 
                    else 
                    {
                        <text>&nbsp;</text>
                    }
                </a>
            </div>
        </div>
    </div>  
</div>